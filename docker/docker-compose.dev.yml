version: '3.7'
services: 
  mixer-backend: 
    container_name: mixer-backend

    build:
      context: ../backend

    ports:
      - "3000:3000"

    networks:
      - "mixer-net"

    environment:
      - NODE_ENV=docker-dev

  mixer-testnet:
    container_name: mixer-testnet

    build:
      context: ../contracts

    ports:
      - "8575:8575"

    networks:
      - "mixer-net"

    environment:
      - NODE_ENV=docker-dev

    secrets:
      - privateKeysPath

  mixer-frontend:
    container_name: mixer-frontend

    build:
      context: ../frontend

    ports:
      - target: 8001
      - published: 80
      - protocol: tcp
      - mode: host

    networks:
      - "mixer-net"

    environment:
      - NODE_ENV=docker-dev

  mixer-etcd:
    container_name: mixer-etcd

    image: jumanjiman/etcd

    ports:
      - "2379:2379"

    networks:
      - "mixer-net"

    environment:
      - NODE_ENV=docker-dev

networks:
  mixer-net:

secrets:
  privateKeysPath:
    file: "../../MIXER_SECRETS/privateKeys.json"
